<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <select name="" id="county">
        <option>--請選擇--</option>
    </select>
    <div class="container">

    </div>
    <script>
        $(function(){
            $.ajax({
                url: 'https://data.epa.gov.tw/api/v1/aqx_p_432?limit=1000&api_key=9be7b239-557b-4c10-9775-78cadfc555e9&sort=ImportDate%20desc&format=json',
                // url:'https://data.coa.gov.tw/Service/OpenData/TransService.aspx?UnitId=QcbUEzN6E6DL',
                dataType:'json',
                success:function(data){
                    // console.log(data.records);
                    
                    // let counties = data.records.map(function(data){
                    //     return data.County;
                    // })
                    let counties = data.records.map(data => data.County);
                    let county = [...new Set(counties)];
                    county.forEach(data=>{
                        $('#county').append(`<option value="${data}">${data}</option>`);
                    })

                    $('#county').change(function(){
                        $('.container').empty();
                        let county = $(this).val();
                        data.records.forEach(function(data){
                            if(county === data.County){ 
                                let content = `
                                <div>
                                    <h2>${data.SiteName}</h2>
                                    <div>一氧化氮(NO):${data.NO}</div>
                                    <div>二氧化氮(NO2):${data.NO2}</div>
                                    <div>臭氧(O3):${data.O3}</div>
                                    <div>PM2.5:${data['PM2.5']}</div>
                                    <div>二氧化硫(SO2):${data.SO2}</div>
                                    </div>
                                    `;
                                $('.container').append(content);
                            }
                        })
                    })
                    
                   
                },
                error:function(){

                }
            })
        })
    </script>
</body>
</html>